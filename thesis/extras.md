To address these multifaceted challenges, a robust IoT cloud application must embody several critical characteristics. Resilience to failures is paramount, ensuring continuous operation even in adverse scenarios, a vital consideration given the distributed nature and potential for faulty connections in IoT actuator systems. Consequently, the primary technical challenge was not just integrating devices, but establishing a resilient and highly scalable backbone capable of overcoming these physical and broker layer limitations to ensure consistent, fault-tolerant, real-time data flow from a massive, distributed network of actuators. Addressing this specific challenge requires a paradigm shift from conventional RPC calls to a new distributed system design that can gracefully handle the lack of traditional partitioning without sacrificing horizontal scaling requirements. (HEIMERDINGER; Weinstock, 1992).

In this study, we'll dive into the scaling limitations of traditional broker architectures as applied to our specific use case, particularly when managing the bidirectional communication and real-time control demands of large-scale Electronic Shelf Label (ESL) deployments. This includes a detailed examination of how the MQTT protocol, while effective for general load balancing, encounters significant hurdles in maintaining the request-reply pattern necessary for Remote Procedure Calls (RPCs) when horizontal scaling is implemented, as replies can be misrouted to different nodes than their originating requests. We propose and evaluate a novel approach leveraging distributed queues to overcome these architectural constraints, ensuring seamless, scalable, and reliable operations for IoT cloud applications involving actuators.

A significant technical hurdle encountered stemmed from the chosen communication protocol: the ESLs communicate via Bluetooth to dedicated gateways (GWs) that themselves are exposed via MQTT. While MQTT works well for general load balancing, it breaks the request-reply pattern needed for RPCs when horizontal scaling is applied, as the reply might go to a different node than the one that sent the request.

The inherent characteristics of a large hardware store environment, however, severely compromised the reliability and range of these Bluetooth signals. This led to the inability for the gateways to consitently maintain stable connections wth large number of ESLs, directly impacting the real-time update capabilities and overall system efficiency.

The presence of numerous metal, glass, wooden, and concrete objects, along with the constant movement of forklifts within the store, created a highly dynamic and challenging radio-frequency landscape. These obstacles led to frequent signal degradation, packet loss, and an inability for the gateways to consistently maintain stable connections with the large number of ESLs, directly impacting the real-time update capabilities and overall system efficiency.

The constant signal degradation and interference in the store's environment meant that device communication frequently required retries via MQTT. This posed a significant challenge for horizontal scalability: due to MQTT's strict round-robin message distribution pattern among subscribed nodes, the node that sent a Remote Procedure Call (RPC) request often did not receive its corresponding reply. This critical issue created a new hurdle for developing a system that was both scalable and reliable. In other words, traditional partioning methods of storing records in exactly one partition (KLEPPMANN, M. 2007, p.199) would not work in scaled-out environments.

The reliance on Bluetooth for ESL communication, while energy-efficient, proved particularly vulnerable to the signal attenuation and interference caused by the store's physical layout and dynamic elements like forklifts. This frequently led to unreliable data transmission and significant delays in real-time updates, preventing the system from achieving its operational goals of dynamic pricing and inventory management. Consequently, the primary technical challenge was not just integrating devices, but establishing a resilient and highly scalable backbone capable of overcoming these physical and broker layer limitations to ensure consistent, fault-tolerant, real-time data flow from a massive, distributed network of actuators. Addressing this specific challenge requires a paradigm shift from conventional RPC calls to a new distributed system design that can gracefully handle the lack of traditional partitioning without sacrificing horizontal scaling requirements. (HEIMERDINGER; Weinstock, 1992).
